
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Simple MD Tutorial of Alanine Dipeptide &#8212; Coding Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/card.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://van-richard.github.io/CodingNotes/notebooks/simulation/simple.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/van-abstract.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/OMGITSvanADIUM" rel="noopener" target="_blank" title="Twitter"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/van-richard" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://linkedin.com/van-richard" rel="noopener" target="_blank" title="LinkedIn"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://scholar.google.com/{citations?user=YQmlIIwAAAAJ&hl=en" rel="noopener" target="_blank" title="Google"><span><i class="fa-brands fa-google"></i></span>
            <label class="sr-only">Google</label></a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-files-folders">
   Prepare Files &amp; Folders
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-topology-and-coordinate-files-inputs">
   Prepare Topology and Coordinate Files Inputs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-md-inputs-simulation-settings">
   Prepare MD Inputs - Simulation Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-simulation">
   Running the Simulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-trajectory">
   Visualize Trajectory
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="simple-md-tutorial-of-alanine-dipeptide">
<h1>Simple MD Tutorial of Alanine Dipeptide<a class="headerlink" href="#simple-md-tutorial-of-alanine-dipeptide" title="Permalink to this headline">#</a></h1>
<p>A simple example of how to run MD simulations is with the molecule, Alanine Dipeptide. We will model the residue, solvate it in a water box, equilibrate the system, and run MD production simulations with AmberTools. This should take roughly an hour.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/simple.mov"><img alt="../../_images/simple.mov" src="../../_images/simple.mov" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-text">MD trajectory of Alanine Dipeptide (<em>shown as ball-and-stick</em>) solvated in water (<em>shown as line</em>) viewed on VMD.</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The system, Alanine Dipeptide, is the amino acid, Alanine, with the charged ends neutralized. This is done by “capping” the N-terminal with an acetyl group, and C-terminal with N-methylamide.</p>
<p>In this tutorial, we will:</p>
<ul class="simple">
<li><p>Make a <code class="docutils literal notranslate"><span class="pre">~/Tutorials/</span></code> folder all of our projects</p></li>
<li><p>Add a new project folder called <code class="docutils literal notranslate"><span class="pre">simple</span></code></p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">tleap</span></code> to make the molecule (in Amber format)</p></li>
<li><p>Prepare inputs for MD simulations</p></li>
<li><p>Run MD simulations with <code class="docutils literal notranslate"><span class="pre">sander</span></code></p></li>
<li><p>Analyze the trajectory</p></li>
</ul>
<p><strong>This assumes you have already installed some form of conda, and made the conda environment “ambertools”.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This tutorial can be perform on your local computer</p></li>
<li><p>Download my files for reference: <span class="xref myst">simple.tar.bz2</span></p></li>
</ul>
</div>
<section id="prepare-files-folders">
<h2>Prepare Files &amp; Folders<a class="headerlink" href="#prepare-files-folders" title="Permalink to this headline">#</a></h2>
<p>First, set up the directories by creating a folder for “Tutorials”, then make a project folder for the “simple” simulation project. <em>Optionally, if you downloaded the reference file, we will move <code class="docutils literal notranslate"><span class="pre">simple.tar.bz2</span></code> into a reference folder.</em></p>
<p>Create:</p>
<ol class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code> folder in our home</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">simple</span></code> folder inside <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code></p>
<ul class="simple">
<li><p>i.e. ~/Tutorials/simple</p></li>
</ul>
</li>
<li><p>(Optional) The downloaded reference folder <code class="docutils literal notranslate"><span class="pre">simple</span></code> in <code class="docutils literal notranslate"><span class="pre">~/Tutorials/references/</span></code></p>
<ul class="simple">
<li><p>i.e. ~/Tutorials/references/simple</p></li>
</ul>
</li>
</ol>
<p>Open terminal and check where you are:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">pwd</span>
</pre></div>
</div>
<p>Make a new directory for projects called, “Tutorials”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>~/Tutorials
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">~/</span></code> before Tutorials is the home path, i.e. <code class="docutils literal notranslate"><span class="pre">$HOME/Tutorials</span></code>.</p>
<p>Go inside <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code> and  make the first project folder called, “simple”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>simple
</pre></div>
</div>
<p>If you downloaded my reference files, then make another folder called “references”, with <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">references</span></code>, then unzip and move the folder into references,</p>
<div class="dropdown admonition">
<p class="admonition-title">Try me!!</p>
<p>Assuming you saved my reference file by using your mouse, moved the file to <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code>, and extracted the files by clicking…</p>
<p>I want to share the command line approach! Downloading and extracting compressed files via command line is helpful because it can be automated! Plus, in the future, we don’t want to download files locally, then upload to the supercomputer… It becomes tedious…</p>
<p>In the terminal, go to where you want the file to be saved (<code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~/Tutorials/</span></code>):</p>
<ul class="simple">
<li><p>Download the <code class="docutils literal notranslate"><span class="pre">.tar.bz2</span></code> file with either <code class="docutils literal notranslate"><span class="pre">curl</span></code> or <code class="docutils literal notranslate"><span class="pre">wget</span></code> <em>depending on your OS</em>.</p></li>
<li><p>Extract the files with <code class="docutils literal notranslate"><span class="pre">tar</span></code></p></li>
</ul>
<div class="sd-tab-set docutils">
<input checked="checked" id="6217beb2-2c06-40ac-b053-4f4cde7b675e" name="a0f11f95-af05-433f-9d48-3e6d28dd92e6" type="radio">
</input><label class="sd-tab-label" for="6217beb2-2c06-40ac-b053-4f4cde7b675e">
MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-<span class="w"> </span>O<span class="w"> </span>https://van-richard.github.io/CodingNotes/_downloads/053d20a2b9fe9f09025552a74192e439/simple.tar.bz2
tar<span class="w"> </span>xvfj<span class="w"> </span>simple.tar.bz2<span class="w"> </span>
</pre></div>
</div>
</div>
<input id="fe65a2c7-653a-40e3-9228-1e2b7dcba76f" name="a0f11f95-af05-433f-9d48-3e6d28dd92e6" type="radio">
</input><label class="sd-tab-label" for="fe65a2c7-653a-40e3-9228-1e2b7dcba76f">
Linux</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://van-richard.github.io/CodingNotes/_downloads/053d20a2b9fe9f09025552a74192e439/simple.tar.bz2
tar<span class="w"> </span>xvfj<span class="w"> </span>simple.tar.bz2<span class="w"> </span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p>In terms of the terminal, do you know where you are or what is in this directory? If you forgot the path, then run <code class="docutils literal notranslate"><span class="pre">pwd</span></code>. This will tell you where you are with respect to your home directory. To see files/folders, run <code class="docutils literal notranslate"><span class="pre">ls</span></code>.</p>
</div>
</section>
<section id="prepare-topology-and-coordinate-files-inputs">
<h2>Prepare Topology and Coordinate Files Inputs<a class="headerlink" href="#prepare-topology-and-coordinate-files-inputs" title="Permalink to this headline">#</a></h2>
<p>Since Alanine dipeptide is still an amino acid, we can use <code class="docutils literal notranslate"><span class="pre">tleap</span></code> to generate the topology (<code class="docutils literal notranslate"><span class="pre">.parm7</span></code>) and coordinate files(<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>). The <code class="docutils literal notranslate"><span class="pre">tleap</span></code> program contains reference coordinates for standard residues to generate  missing atoms, this function is base on the residue name.</p>
<p>To give <code class="docutils literal notranslate"><span class="pre">tleap</span></code> instructions, make a file called, “<a class="reference external" href="http://tleap.in">tleap.in</a>” using <code class="docutils literal notranslate"><span class="pre">vi</span></code>, and copy the following lines:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nb">source</span><span class="w"> </span>leaprc.protein.ff19SB
<span class="linenos"> 2</span><span class="nb">source</span><span class="w"> </span>leaprc.water.TIP3P
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="nv">system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>sequence<span class="w"> </span><span class="o">{</span><span class="w"> </span>ACE<span class="w"> </span>ALA<span class="w"> </span>NME<span class="w"> </span><span class="o">}</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>solvatebox<span class="w"> </span>system<span class="w"> </span>TIP3PBOX<span class="w"> </span><span class="m">12</span>.0<span class="w"> </span>iso<span class="w"> </span><span class="m">0</span>.8
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>saveamberparm<span class="w"> </span>system<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>step3_pbcsetup.rst7
<span class="linenos"> 9</span>
<span class="linenos">10</span>quit
</pre></div>
</div>
<p>Briefly, the:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code> line tell Amber which force field parameters we want for our molecules, this is always at the top of the file</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">leaprc.protein.ff19SB</span></code> contains protein parameters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">leaprc.water.TIP3P</span></code> has the water parameters</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">system</span> <span class="pre">=</span> <span class="pre">sequence</span> <span class="pre">{</span> <span class="pre">ACE</span> <span class="pre">ALA</span> <span class="pre">NME</span> <span class="pre">}</span></code> line makes use of the <code class="docutils literal notranslate"><span class="pre">sequence</span></code> command which combines amino acid residues together to build a molecule, and this is stored as “system” variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solvatebox</span> <span class="pre">system</span> <span class="pre">TIP3PBOX</span> <span class="pre">12.0</span> <span class="pre">iso</span> <span class="pre">0.8</span></code> line create a a water box around the <code class="docutils literal notranslate"><span class="pre">system</span></code>, such that the minimum distance between any atom in <code class="docutils literal notranslate"><span class="pre">system</span></code> and the edge of the periodic box <code class="docutils literal notranslate"><span class="pre">12.0</span></code> Å.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">iso</span></code> rotates the <code class="docutils literal notranslate"><span class="pre">system</span></code> to orient the principal axes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code> is how close a solvent atom can be to the system atoms</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveamberparm</span> <span class="pre">system</span> <span class="pre">step3_pbcsetup.parm7</span> <span class="pre">step3_pbcsetup.rst7</span></code> line saves <code class="docutils literal notranslate"><span class="pre">system</span></code> as Amber topology (<code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.parm7</span></code>) and coordinate (<code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.rst7</span></code>) files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quit</span></code> line exits the tleap program.</p></li>
</ul>
<p>Now we can run <code class="docutils literal notranslate"><span class="pre">tleap</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap<span class="w"> </span>-sf<span class="w"> </span>tleap.in
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-sf</span></code> for <code class="docutils literal notranslate"><span class="pre">tleap</span></code> lets us run the script <code class="docutils literal notranslate"><span class="pre">tleap.in</span></code>, otherwise it will run interactively in the command line</p>
<p>If you list the files in this directory, you should see <code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.parm7</span></code> and <code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.rst7</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Visualize these two files with VMD. Always do this before moving on!</p>
</div>
</section>
<section id="prepare-md-inputs-simulation-settings">
<h2>Prepare MD Inputs - Simulation Settings<a class="headerlink" href="#prepare-md-inputs-simulation-settings" title="Permalink to this headline">#</a></h2>
<p>Now, we will make 3 MD input files for running Amber simulations. These files contain the settings for each part of the simulations. The 3 parts involve:</p>
<ol class="simple">
<li><p>Minimization</p></li>
<li><p>Heating (for 20 ps from 0 K to 300 K)</p></li>
<li><p>Production MD (100 ps at 300 K and 1 atm)</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="7175c0e0-b787-48d1-9c13-90bb28a102a3" name="7dd8db50-906f-40ec-bc5d-842955f31840" type="radio">
</input><label class="sd-tab-label" for="7175c0e0-b787-48d1-9c13-90bb28a102a3">
min.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Minimization<span class="w"> </span>input<span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>explicit<span class="w"> </span>solvent
<span class="w"> </span><span class="p">&amp;</span>cntrl
<span class="w">  </span>!<span class="w"> </span>Minimization<span class="w"> </span>options
<span class="w">  </span><span class="nv">imin</span><span class="o">=</span><span class="m">1</span><span class="w">         </span>!<span class="w"> </span>Turn<span class="w"> </span>on<span class="w"> </span>minimization
<span class="w">  </span><span class="nv">maxcyc</span><span class="o">=</span><span class="m">2000</span>,<span class="w">   </span>!<span class="w">  </span>Maximum<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>minimization<span class="w"> </span>cycles
<span class="w">  </span><span class="nv">ncyc</span><span class="o">=</span><span class="m">1000</span>,<span class="w">     </span>!<span class="w"> </span>Steepest-descent<span class="w"> </span>steps,<span class="w"> </span>better<span class="w"> </span><span class="k">for</span><span class="w"> </span>strained<span class="w"> </span>systems<span class="w">       </span>

<span class="w">  </span>!<span class="w"> </span>Potential<span class="w"> </span>energy<span class="w"> </span><span class="k">function</span><span class="w"> </span>options
<span class="w">  </span><span class="nv">cut</span><span class="o">=</span><span class="m">8</span>.0,<span class="w">       </span>!<span class="w"> </span>nonbonded<span class="w"> </span>cutoff,<span class="w"> </span><span class="k">in</span><span class="w"> </span>angstroms
<span class="w"> </span>
<span class="w">  </span>!<span class="w"> </span>Control<span class="w"> </span>how<span class="w"> </span>often<span class="w"> </span>information<span class="w"> </span>is<span class="w"> </span>printed<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>file
<span class="w">  </span><span class="nv">ntpr</span><span class="o">=</span><span class="m">100</span>,<span class="w">      </span>!<span class="w"> </span>Print<span class="w"> </span>energies<span class="w"> </span>every<span class="w"> </span><span class="m">100</span><span class="w"> </span>steps
<span class="w"> </span>/
<span class="w"> </span>
</pre></div>
</div>
</div>
<input id="5d1d2ea4-23e6-43e3-80bf-19500275baa5" name="7dd8db50-906f-40ec-bc5d-842955f31840" type="radio">
</input><label class="sd-tab-label" for="5d1d2ea4-23e6-43e3-80bf-19500275baa5">
heat.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>A<span class="w"> </span>NVT<span class="w"> </span>simulation<span class="w"> </span><span class="k">for</span><span class="w"> </span>common<span class="w"> </span>production-level<span class="w"> </span>simulations
<span class="w"> </span><span class="p">&amp;</span>cntrl
<span class="w">  </span><span class="nv">imin</span><span class="o">=</span><span class="m">0</span>,<span class="w">        </span>!<span class="w"> </span>Turn<span class="w"> </span>off<span class="w"> </span>minimization
<span class="w">  </span><span class="nv">irest</span><span class="o">=</span><span class="m">0</span>,<span class="w">       </span>!<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>NOT<span class="w"> </span>a<span class="w"> </span>restart<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>old<span class="w"> </span>MD<span class="w"> </span>simulation
<span class="w">  </span><span class="nv">ntx</span><span class="o">=</span><span class="m">1</span>,<span class="w">         </span>!<span class="w"> </span>So<span class="w"> </span>our<span class="w"> </span>inpcrd<span class="w"> </span>file<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>velocities
<span class="w">   </span>
<span class="w">  </span>!<span class="w"> </span>Temperature<span class="w"> </span>control
<span class="w">  </span><span class="nv">ntt</span><span class="o">=</span><span class="m">3</span>,<span class="w">         </span>!<span class="w"> </span>Langevin<span class="w"> </span>dynamics
<span class="w">  </span><span class="nv">gamma_ln</span><span class="o">=</span><span class="m">1</span>.0,<span class="w">  </span>!<span class="w"> </span>Friction<span class="w"> </span>coefficient<span class="w"> </span><span class="o">(</span>ps^-1<span class="o">)</span>
<span class="w">  </span><span class="nv">tempi</span><span class="o">=</span><span class="m">0</span>.0,<span class="w">     </span>!<span class="w"> </span>Initial<span class="w"> </span>temp<span class="w"> </span>--<span class="w"> </span>give<span class="w"> </span>it<span class="w"> </span>some<span class="w"> </span>small<span class="w"> </span>random<span class="w"> </span>velocities<span class="w">   </span>
<span class="w">  </span><span class="nv">temp0</span><span class="o">=</span><span class="m">300</span>,<span class="w">     </span>!<span class="w"> </span>Target<span class="w"> </span>temperature

<span class="w">  </span>!<span class="w"> </span>Potential<span class="w"> </span>energy<span class="w"> </span>control
<span class="w">  </span><span class="nv">cut</span><span class="o">=</span><span class="m">0</span>,<span class="w">       </span>!<span class="w"> </span>nonbonded<span class="w"> </span>cutoff,<span class="w"> </span><span class="k">in</span><span class="w"> </span>angstroms
<span class="w"> </span>
<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>settings
<span class="w">  </span><span class="nv">nstlim</span><span class="o">=</span><span class="m">10000</span>,<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>steps
<span class="w">  </span><span class="nv">dt</span><span class="o">=</span><span class="m">0</span>.002,<span class="w">      </span>!<span class="w"> </span>Time<span class="w"> </span>step<span class="w"> </span><span class="o">(</span>ps<span class="o">)</span>

<span class="w">  </span>!<span class="w"> </span>SHAKE
<span class="w">  </span><span class="nv">ntc</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Constrain<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span><span class="nv">ntf</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Do<span class="w"> </span>not<span class="w"> </span>calculate<span class="w"> </span>forces<span class="w"> </span>of<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Control<span class="w"> </span>how<span class="w"> </span>often<span class="w"> </span>information<span class="w"> </span>is<span class="w"> </span>printed
<span class="w">  </span><span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,<span class="w">      </span>!<span class="w"> </span>Print<span class="w"> </span>coordinates<span class="w"> </span>every<span class="w"> </span>ntwx<span class="w"> </span>steps<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>trajectory
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Restraints
<span class="w">  </span><span class="nv">nmropt</span><span class="o">=</span><span class="m">1</span>,<span class="w">      </span>!<span class="w"> </span>Turn<span class="w"> </span>on<span class="w"> </span>Restraints
<span class="w"> </span>/
!<span class="w"> </span>This<span class="w"> </span>section<span class="w"> </span>will<span class="w"> </span>vary<span class="w"> </span>the<span class="w"> </span>temperature<span class="w"> </span>
!<span class="w"> </span>For<span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span><span class="m">9000</span><span class="w"> </span>steps,<span class="w"> </span>temp<span class="w"> </span>increases<span class="w"> </span>from<span class="w"> </span><span class="m">0</span><span class="w"> </span>to<span class="w"> </span><span class="m">300</span><span class="w"> </span>K.
!<span class="w"> </span>For<span class="w"> </span>steps<span class="w"> </span><span class="m">9001</span><span class="w"> </span>to<span class="w"> </span><span class="m">10000</span>,<span class="w"> </span>temp<span class="w"> </span>will<span class="w"> </span>remain<span class="w"> </span>at<span class="w"> </span><span class="m">300</span><span class="w"> </span>K
<span class="p">&amp;</span>wt<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s1">&#39;TEMP0&#39;</span>,<span class="w"> </span><span class="nv">istep1</span><span class="o">=</span><span class="m">0</span>,<span class="w"> </span><span class="nv">istep2</span><span class="o">=</span><span class="m">9000</span>,<span class="w"> </span><span class="nv">value1</span><span class="o">=</span><span class="m">0</span>.0,<span class="w"> </span><span class="nv">value2</span><span class="o">=</span><span class="m">300</span>.0<span class="w"> </span>/
<span class="p">&amp;</span>wt<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s1">&#39;TEMP0&#39;</span>,<span class="w"> </span><span class="nv">istep1</span><span class="o">=</span><span class="m">9001</span>,<span class="w"> </span><span class="nv">istep2</span><span class="o">=</span><span class="m">10000</span>,<span class="w"> </span><span class="nv">value1</span><span class="o">=</span><span class="m">300</span>.0,<span class="w"> </span><span class="nv">value2</span><span class="o">=</span><span class="m">300</span>.0<span class="w"> </span>/
<span class="p">&amp;</span>wt<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s1">&#39;END&#39;</span><span class="w"> </span>/
</pre></div>
</div>
</div>
<input id="4f263e13-ab8d-4881-861e-50dddac5e609" name="7dd8db50-906f-40ec-bc5d-842955f31840" type="radio">
</input><label class="sd-tab-label" for="4f263e13-ab8d-4881-861e-50dddac5e609">
prod.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>A<span class="w"> </span>NPT<span class="w"> </span>simulation<span class="w"> </span><span class="k">for</span><span class="w"> </span>common<span class="w"> </span>production-level<span class="w"> </span>simulations
<span class="w"> </span><span class="p">&amp;</span>cntrl
<span class="w">  </span><span class="nv">imin</span><span class="o">=</span><span class="m">0</span>,<span class="w">        </span>!<span class="w"> </span>Turn<span class="w"> </span>off<span class="w"> </span>minimization
<span class="w">  </span><span class="nv">irest</span><span class="o">=</span><span class="m">1</span>,<span class="w">       </span>!<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>restart<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>old<span class="w"> </span>MD<span class="w"> </span>simulation
<span class="w">  </span><span class="nv">ntx</span><span class="o">=</span><span class="m">5</span>,<span class="w">         </span>!<span class="w"> </span>So<span class="w"> </span>our<span class="w"> </span>inpcrd<span class="w"> </span>file<span class="w"> </span>has<span class="w"> </span>velocities
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Temperature<span class="w"> </span>control
<span class="w">  </span><span class="nv">ntt</span><span class="o">=</span><span class="m">3</span>,<span class="w">         </span>!<span class="w"> </span>Langevin<span class="w"> </span>dynamics
<span class="w">  </span><span class="nv">gamma_ln</span><span class="o">=</span><span class="m">2</span>.0,<span class="w">  </span>!<span class="w"> </span>Friction<span class="w"> </span>coefficient<span class="w"> </span><span class="o">(</span>ps^-1<span class="o">)</span><span class="w">   </span>
<span class="w">  </span><span class="nv">temp0</span><span class="o">=</span><span class="m">300</span>,<span class="w">     </span>!<span class="w"> </span>Target<span class="w"> </span>temperature
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Potential<span class="w"> </span>energy<span class="w"> </span>control
<span class="w">  </span><span class="nv">cut</span><span class="o">=</span><span class="m">8</span>.0,<span class="w">       </span>!<span class="w"> </span>nonbonded<span class="w"> </span>cutoff,<span class="w"> </span><span class="k">in</span><span class="w"> </span>angstroms

<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>settings
<span class="w">  </span><span class="nv">nstlim</span><span class="o">=</span><span class="m">50000</span>,<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>steps
<span class="w">  </span><span class="nv">dt</span><span class="o">=</span><span class="m">0</span>.002,<span class="w">      </span>!<span class="w"> </span>Time<span class="w"> </span>step<span class="w"> </span><span class="o">(</span>ps<span class="o">)</span>

<span class="w">  </span>!<span class="w"> </span>SHAKE
<span class="w">  </span><span class="nv">ntc</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Constrain<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span><span class="nv">ntf</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Do<span class="w"> </span>not<span class="w"> </span>calculate<span class="w"> </span>forces<span class="w"> </span>of<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Control<span class="w"> </span>how<span class="w"> </span>often<span class="w"> </span>information<span class="w"> </span>is<span class="w"> </span>printed
<span class="w">  </span><span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,<span class="w">      </span>!<span class="w"> </span>Print<span class="w"> </span>coordinates<span class="w"> </span>every<span class="w"> </span>ntwx<span class="w"> </span>steps<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>trajectory<span class="w">  </span>
<span class="w">  </span><span class="nv">ntpr</span><span class="o">=</span><span class="m">100</span>,
<span class="w">  </span><span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,

<span class="w">  </span>!<span class="w"> </span>Constant<span class="w"> </span>pressure<span class="w"> </span>control.
<span class="w">  </span><span class="nv">barostat</span><span class="o">=</span><span class="m">1</span>,<span class="w">    </span>!<span class="w"> </span>Berendsen<span class="w"> </span>barostat...<span class="w"> </span>change<span class="w"> </span>to<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>MC
<span class="w">  </span><span class="nv">ntp</span><span class="o">=</span><span class="m">1</span>,<span class="w">         </span>!<span class="w"> </span><span class="nv">1</span><span class="o">=</span>isotropic,<span class="w"> </span><span class="nv">2</span><span class="o">=</span>anisotropic,<span class="w"> </span><span class="nv">3</span><span class="o">=</span>semi-isotropic<span class="w"> </span>w/<span class="w"> </span>surften
<span class="w">  </span><span class="nv">pres0</span><span class="o">=</span><span class="m">1</span>.0,<span class="w">     </span>!<span class="w"> </span>Target<span class="w"> </span>external<span class="w"> </span>pressure,<span class="w"> </span><span class="k">in</span><span class="w"> </span>bar
<span class="w">  </span><span class="nv">taup</span><span class="o">=</span><span class="m">1</span>.0,<span class="w">      </span>!<span class="w"> </span>Pressure<span class="w"> </span>relaxation<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span>ps<span class="o">)</span>
<span class="w"> </span>/
<span class="w"> </span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-the-simulation">
<h2>Running the Simulation<a class="headerlink" href="#running-the-simulation" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Amber has 2 MD engines called, <code class="docutils literal notranslate"><span class="pre">sander</span></code> and <code class="docutils literal notranslate"><span class="pre">pmemd</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sander</span></code> is free and shipped with Ambertools</p></li>
</ul>
<p>Using <code class="docutils literal notranslate"><span class="pre">sander</span></code>, run the following commands in sequential order:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="c1e745ef-48a1-4533-8e24-71db15ae10d7" name="55e06ecf-24be-49cb-beaf-2509a91dc5c6" type="radio">
</input><label class="sd-tab-label" for="c1e745ef-48a1-4533-8e24-71db15ae10d7">
Step 1 - Minimization</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>min.mdin<span class="w"> </span>-p<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>-c<span class="w"> </span>step3_pbcsetup.rst7<span class="w"> </span>-o<span class="w"> </span>min.mdout<span class="w"> </span>-r<span class="w"> </span>min.ncrst<span class="w"> </span>-inf<span class="w"> </span>min.mdinfo
</pre></div>
</div>
</div>
<input id="9cc49678-5dd3-4a14-b195-9c6d275b2e47" name="55e06ecf-24be-49cb-beaf-2509a91dc5c6" type="radio">
</input><label class="sd-tab-label" for="9cc49678-5dd3-4a14-b195-9c6d275b2e47">
Step 2 - Heating</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>heat.mdin<span class="w"> </span>-p<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>-c<span class="w"> </span>min.ncrst<span class="w"> </span>-o<span class="w"> </span>heat.mdout<span class="w"> </span>-r<span class="w"> </span>heat.ncrst<span class="w"> </span>-inf<span class="w"> </span>heat.mdinfo<span class="w"> </span>-x<span class="w"> </span>heat.nc
</pre></div>
</div>
</div>
<input id="66f63a04-6537-4883-94f9-fe7b9ac428dd" name="55e06ecf-24be-49cb-beaf-2509a91dc5c6" type="radio">
</input><label class="sd-tab-label" for="66f63a04-6537-4883-94f9-fe7b9ac428dd">
Step 3 - Production MD</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>prod.mdin<span class="w"> </span>-p<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>-c<span class="w"> </span>heat.ncrst<span class="w"> </span>-o<span class="w"> </span>prod.mdout<span class="w"> </span>-r<span class="w"> </span>prod.ncrst<span class="w"> </span>-inf<span class="w"> </span>prod.mdinfo<span class="w"> </span>-x<span class="w"> </span>prod.nc
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-trajectory">
<h2>Visualize Trajectory<a class="headerlink" href="#visualize-trajectory" title="Permalink to this headline">#</a></h2>
<p>Now you can visual the results with VMD or Chimera, and perform some analysis.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/simulation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright .<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>