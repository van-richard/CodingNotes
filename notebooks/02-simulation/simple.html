
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Simple MD Tutorial of Alanine Dipeptide &#8212; CodingNotes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Applying Distance Restraints in Classical MD SImulations" href="distance.html" />
    <link rel="prev" title="Classical MD" href="md.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/van-abstract.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CodingNotes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    CodingNotes
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Quick Start Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00-quickstart/index.html">
   A (not so) Quick Start Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-quickstart/01terminal.html">
   Terminal, Shell, &amp; Bash
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-quickstart/02vim.html">
   Text Editors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-quickstart/03Supercomputer.html">
   Supercomputers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-quickstart/04PythonConda.html">
   Python
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../00-quickstart/05StructureFiles.html">
   Molecular Structure Files
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-quickstart/06PDBFiles.html">
     Exploring PDB Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00-quickstart/07XYZFiles.html">
     What are XYZ Files?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-quickstart/08BasicMD.html">
   Briefly, Molecular Dynamics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Example Code &amp; More
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01-scripting/index.html">
   Example Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-scripting/bash/overview.html">
   bash Shell
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-scripting/vi/overview.html">
   Text Editing with Vi/Vim
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-scripting/python/overview.html">
   Python &amp; Conda
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-scripting/python/python.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-scripting/python/conda.html">
     Conda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-scripting/python/condaenv.html">
     Conda Environments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-scripting/python/jupyter.html">
     Jupyter Notebooks
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Tutorials
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="md.html">
   Classical MD
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Simple MD Tutorial of Alanine Dipeptide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="distance.html">
     Applying Distance Restraints in Classical MD SImulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="qmmm.html">
   QM/MM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="claisen.html">
     Simple QM/MM Simulation of the Claisen Rearrangment Reaction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="analysis.html">
   Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="rmsd.html">
     RMSD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rmsf.html">
     RMSF
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/van-richard/CodingNotes/main?urlpath=tree/notebooks/notebooks/02-simulation/simple.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/van-richard/CodingNotes"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/van-richard/CodingNotes/issues/new?title=Issue%20on%20page%20%2Fnotebooks/02-simulation/simple.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notebooks/02-simulation/simple.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-files-folders">
   Prepare Files &amp; Folders
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-topology-and-coordinate-files-inputs">
   Prepare Topology and Coordinate Files Inputs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-md-inputs-simulation-settings">
   Prepare MD Inputs - Simulation Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-simulation">
   Running the Simulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-trajectory">
   Visualize Trajectory
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Simple MD Tutorial of Alanine Dipeptide</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-files-folders">
   Prepare Files &amp; Folders
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-topology-and-coordinate-files-inputs">
   Prepare Topology and Coordinate Files Inputs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-md-inputs-simulation-settings">
   Prepare MD Inputs - Simulation Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-simulation">
   Running the Simulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-trajectory">
   Visualize Trajectory
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="simple-md-tutorial-of-alanine-dipeptide">
<h1>Simple MD Tutorial of Alanine Dipeptide<a class="headerlink" href="#simple-md-tutorial-of-alanine-dipeptide" title="Permalink to this headline">#</a></h1>
<p>A simple example of how to run MD simulations is with the molecule, Alanine Dipeptide. We will model the residue, solvate it in a water box, equilibrate the system, and run MD production simulations with AmberTools. This should take roughly an hour.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/simple.mov"><img alt="../../_images/simple.mov" src="../../_images/simple.mov" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">MD trajectory of Alanine Dipeptide (<em>shown as ball-and-stick</em>) solvated in water (<em>shown as line</em>) viewed on VMD.</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The system, Alanine Dipeptide, is the amino acid, Alanine, with the charged ends neutralized. This is done by “capping” the N-terminal with an acetyl group, and C-terminal with N-methylamide.</p>
<p>In this tutorial, we will:</p>
<ul class="simple">
<li><p>Make a <code class="docutils literal notranslate"><span class="pre">~/Tutorials/</span></code> folder all of our projects</p></li>
<li><p>Add a new project folder called <code class="docutils literal notranslate"><span class="pre">simple</span></code></p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">tleap</span></code> to make the molecule (in Amber format)</p></li>
<li><p>Prepare inputs for MD simulations</p></li>
<li><p>Run MD simulations with <code class="docutils literal notranslate"><span class="pre">sander</span></code></p></li>
<li><p>Analyze the trajectory</p></li>
</ul>
<p><strong>This assumes you have already installed some form of conda, and made the conda environment “ambertools”.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This tutorial can be perform on your local computer</p></li>
<li><p>Download my files for reference: <span class="xref myst">simple.tar.bz2</span></p></li>
</ul>
</div>
<section id="prepare-files-folders">
<h2>Prepare Files &amp; Folders<a class="headerlink" href="#prepare-files-folders" title="Permalink to this headline">#</a></h2>
<p>First, set up the directories by creating a folder for “Tutorials”, then make a project folder for the “simple” simulation project. <em>Optionally, if you downloaded the reference file, we will move <code class="docutils literal notranslate"><span class="pre">simple.tar.bz2</span></code> into a reference folder.</em></p>
<p>Create:</p>
<ol class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code> folder in our home</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">simple</span></code> folder inside <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code></p>
<ul class="simple">
<li><p>i.e. ~/Tutorials/simple</p></li>
</ul>
</li>
<li><p>(Optional) The downloaded reference folder <code class="docutils literal notranslate"><span class="pre">simple</span></code> in <code class="docutils literal notranslate"><span class="pre">~/Tutorials/references/</span></code></p>
<ul class="simple">
<li><p>i.e. ~/Tutorials/references/simple</p></li>
</ul>
</li>
</ol>
<p>Open terminal and check where you are:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">pwd</span>
</pre></div>
</div>
<p>Make a new directory for projects called, “Tutorials”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir ~/Tutorials
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">~/</span></code> before Tutorials is the home path, i.e. <code class="docutils literal notranslate"><span class="pre">$HOME/Tutorials</span></code>.</p>
<p>Go inside <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code> and  make the first project folder called, “simple”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir simple
</pre></div>
</div>
<p>If you downloaded my reference files, then make another folder called “references”, with <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">references</span></code>, then unzip and move the folder into references,</p>
<div class="dropdown admonition">
<p class="admonition-title">Try me!!</p>
<p>Assuming you saved my reference file by using your mouse, moved the file to <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code>, and extracted the files by clicking…</p>
<p>I want to share the command line approach! Downloading and extracting compressed files via command line is helpful because it can be automated! Plus, in the future, we don’t want to download files locally, then upload to the supercomputer… It becomes tedious…</p>
<p>In the terminal, go to where you want the file to be saved (<code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~/Tutorials/</span></code>):</p>
<ul class="simple">
<li><p>Download the <code class="docutils literal notranslate"><span class="pre">.tar.bz2</span></code> file with either <code class="docutils literal notranslate"><span class="pre">curl</span></code> or <code class="docutils literal notranslate"><span class="pre">wget</span></code> <em>depending on your OS</em>.</p></li>
<li><p>Extract the files with <code class="docutils literal notranslate"><span class="pre">tar</span></code></p></li>
</ul>
<div class="sd-tab-set docutils">
<input checked="checked" id="08af8bbe-6e18-478c-98a0-40dd29196a5e" name="ed0ea1e9-9ba3-494f-a453-a0018d0ef052" type="radio">
</input><label class="sd-tab-label" for="08af8bbe-6e18-478c-98a0-40dd29196a5e">
MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl - O https://van-richard.github.io/CodingNotes/_downloads/053d20a2b9fe9f09025552a74192e439/simple.tar.bz2
tar xvfj simple.tar.bz2 
</pre></div>
</div>
</div>
<input id="1441d7b9-c5e5-422c-80ed-139b9e34f186" name="ed0ea1e9-9ba3-494f-a453-a0018d0ef052" type="radio">
</input><label class="sd-tab-label" for="1441d7b9-c5e5-422c-80ed-139b9e34f186">
Linux</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://van-richard.github.io/CodingNotes/_downloads/053d20a2b9fe9f09025552a74192e439/simple.tar.bz2
tar xvfj simple.tar.bz2 
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p>In terms of the terminal, do you know where you are or what is in this directory? If you forgot the path, then run <code class="docutils literal notranslate"><span class="pre">pwd</span></code>. This will tell you where you are with respect to your home directory. To see files/folders, run <code class="docutils literal notranslate"><span class="pre">ls</span></code>.</p>
</div>
</section>
<section id="prepare-topology-and-coordinate-files-inputs">
<h2>Prepare Topology and Coordinate Files Inputs<a class="headerlink" href="#prepare-topology-and-coordinate-files-inputs" title="Permalink to this headline">#</a></h2>
<p>Since Alanine dipeptide is still an amino acid, we can use <code class="docutils literal notranslate"><span class="pre">tleap</span></code> to generate the topology (<code class="docutils literal notranslate"><span class="pre">.parm7</span></code>) and coordinate files(<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>). The <code class="docutils literal notranslate"><span class="pre">tleap</span></code> program contains reference coordinates for standard residues to generate  missing atoms, this function is base on the residue name.</p>
<p>To give <code class="docutils literal notranslate"><span class="pre">tleap</span></code> instructions, make a file called, “<a class="reference external" href="http://tleap.in">tleap.in</a>” using <code class="docutils literal notranslate"><span class="pre">vi</span></code>, and copy the following lines:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nb">source</span> leaprc.protein.ff19SB
<span class="linenos"> 2</span><span class="nb">source</span> leaprc.water.TIP3P
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="nv">system</span> <span class="o">=</span> sequence <span class="o">{</span> ACE ALA NME <span class="o">}</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>solvatebox system TIP3PBOX <span class="m">12</span>.0 iso <span class="m">0</span>.8
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>saveamberparm system step3_pbcsetup.parm7 step3_pbcsetup.rst7
<span class="linenos"> 9</span>
<span class="linenos">10</span>quit
</pre></div>
</div>
<p>Briefly, the:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code> line tell Amber which force field parameters we want for our molecules, this is always at the top of the file</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">leaprc.protein.ff19SB</span></code> contains protein parameters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">leaprc.water.TIP3P</span></code> has the water parameters</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">system</span> <span class="pre">=</span> <span class="pre">sequence</span> <span class="pre">{</span> <span class="pre">ACE</span> <span class="pre">ALA</span> <span class="pre">NME</span> <span class="pre">}</span></code> line makes use of the <code class="docutils literal notranslate"><span class="pre">sequence</span></code> command which combines amino acid residues together to build a molecule, and this is stored as “system” variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solvatebox</span> <span class="pre">system</span> <span class="pre">TIP3PBOX</span> <span class="pre">12.0</span> <span class="pre">iso</span> <span class="pre">0.8</span></code> line create a a water box around the <code class="docutils literal notranslate"><span class="pre">system</span></code>, such that the minimum distance between any atom in <code class="docutils literal notranslate"><span class="pre">system</span></code> and the edge of the periodic box <code class="docutils literal notranslate"><span class="pre">12.0</span></code> Å.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">iso</span></code> rotates the <code class="docutils literal notranslate"><span class="pre">system</span></code> to orient the principal axes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code> is how close a solvent atom can be to the system atoms</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveamberparm</span> <span class="pre">system</span> <span class="pre">step3_pbcsetup.parm7</span> <span class="pre">step3_pbcsetup.rst7</span></code> line saves <code class="docutils literal notranslate"><span class="pre">system</span></code> as Amber topology (<code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.parm7</span></code>) and coordinate (<code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.rst7</span></code>) files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quit</span></code> line exits the tleap program.</p></li>
</ul>
<p>Now we can run <code class="docutils literal notranslate"><span class="pre">tleap</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap -sf tleap.in
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-sf</span></code> for <code class="docutils literal notranslate"><span class="pre">tleap</span></code> lets us run the script <code class="docutils literal notranslate"><span class="pre">tleap.in</span></code>, otherwise it will run interactively in the command line</p>
<p>If you list the files in this directory, you should see <code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.parm7</span></code> and <code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.rst7</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Visualize these two files with VMD. Always do this before moving on!</p>
</div>
</section>
<section id="prepare-md-inputs-simulation-settings">
<h2>Prepare MD Inputs - Simulation Settings<a class="headerlink" href="#prepare-md-inputs-simulation-settings" title="Permalink to this headline">#</a></h2>
<p>Now, we will make 3 MD input files for running Amber simulations. These files contain the settings for each part of the simulations. The 3 parts involve:</p>
<ol class="simple">
<li><p>Minimization</p></li>
<li><p>Heating (for 20 ps from 0 K to 300 K)</p></li>
<li><p>Production MD (100 ps at 300 K and 1 atm)</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="17b99f56-088b-4ef1-9c61-96b7e580213f" name="c97cce4f-df89-4357-85c9-44c4dd165013" type="radio">
</input><label class="sd-tab-label" for="17b99f56-088b-4ef1-9c61-96b7e580213f">
min.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Minimization input file <span class="k">in</span> explicit solvent
 <span class="p">&amp;</span>cntrl
  ! Minimization options
  <span class="nv">imin</span><span class="o">=</span><span class="m">1</span>         ! Turn on minimization
  <span class="nv">maxcyc</span><span class="o">=</span><span class="m">2000</span>,   !  Maximum number of minimization cycles
  <span class="nv">ncyc</span><span class="o">=</span><span class="m">1000</span>,     ! Steepest-descent steps, better <span class="k">for</span> strained systems       

  ! Potential energy <span class="k">function</span> options
  <span class="nv">cut</span><span class="o">=</span><span class="m">8</span>.0,       ! nonbonded cutoff, <span class="k">in</span> angstroms
 
  ! Control how often information is printed to the output file
  <span class="nv">ntpr</span><span class="o">=</span><span class="m">100</span>,      ! Print energies every <span class="m">100</span> steps
 /
 
</pre></div>
</div>
</div>
<input id="2487b7b9-94d3-4636-a418-a61b4ef408fb" name="c97cce4f-df89-4357-85c9-44c4dd165013" type="radio">
</input><label class="sd-tab-label" for="2487b7b9-94d3-4636-a418-a61b4ef408fb">
heat.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>A NVT simulation <span class="k">for</span> common production-level simulations
 <span class="p">&amp;</span>cntrl
  <span class="nv">imin</span><span class="o">=</span><span class="m">0</span>,        ! Turn off minimization
  <span class="nv">irest</span><span class="o">=</span><span class="m">0</span>,       ! This is NOT a restart of an old MD simulation
  <span class="nv">ntx</span><span class="o">=</span><span class="m">1</span>,         ! So our inpcrd file has no velocities
   
  ! Temperature control
  <span class="nv">ntt</span><span class="o">=</span><span class="m">3</span>,         ! Langevin dynamics
  <span class="nv">gamma_ln</span><span class="o">=</span><span class="m">1</span>.0,  ! Friction coefficient <span class="o">(</span>ps^-1<span class="o">)</span>
  <span class="nv">tempi</span><span class="o">=</span><span class="m">0</span>.0,     ! Initial temp -- give it some small random velocities   
  <span class="nv">temp0</span><span class="o">=</span><span class="m">300</span>,     ! Target temperature

  ! Potential energy control
  <span class="nv">cut</span><span class="o">=</span><span class="m">0</span>,       ! nonbonded cutoff, <span class="k">in</span> angstroms
 
  ! MD settings
  <span class="nv">nstlim</span><span class="o">=</span><span class="m">10000</span>,  ! MD steps
  <span class="nv">dt</span><span class="o">=</span><span class="m">0</span>.002,      ! Time step <span class="o">(</span>ps<span class="o">)</span>

  ! SHAKE
  <span class="nv">ntc</span><span class="o">=</span><span class="m">2</span>,         ! Constrain bonds containing hydrogen
  <span class="nv">ntf</span><span class="o">=</span><span class="m">2</span>,         ! Do not calculate forces of bonds containing hydrogen
  
  ! Control how often information is printed
  <span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,      ! Print coordinates every ntwx steps to the trajectory
  
  ! Restraints
  <span class="nv">nmropt</span><span class="o">=</span><span class="m">1</span>,      ! Turn on Restraints
 /
! This section will vary the temperature 
! For the first <span class="m">9000</span> steps, temp increases from <span class="m">0</span> to <span class="m">300</span> K.
! For steps <span class="m">9001</span> to <span class="m">10000</span>, temp will remain at <span class="m">300</span> K
<span class="p">&amp;</span>wt <span class="nv">type</span><span class="o">=</span><span class="s1">&#39;TEMP0&#39;</span>, <span class="nv">istep1</span><span class="o">=</span><span class="m">0</span>, <span class="nv">istep2</span><span class="o">=</span><span class="m">9000</span>, <span class="nv">value1</span><span class="o">=</span><span class="m">0</span>.0, <span class="nv">value2</span><span class="o">=</span><span class="m">300</span>.0 /
<span class="p">&amp;</span>wt <span class="nv">type</span><span class="o">=</span><span class="s1">&#39;TEMP0&#39;</span>, <span class="nv">istep1</span><span class="o">=</span><span class="m">9001</span>, <span class="nv">istep2</span><span class="o">=</span><span class="m">10000</span>, <span class="nv">value1</span><span class="o">=</span><span class="m">300</span>.0, <span class="nv">value2</span><span class="o">=</span><span class="m">300</span>.0 /
<span class="p">&amp;</span>wt <span class="nv">type</span><span class="o">=</span><span class="s1">&#39;END&#39;</span> /
</pre></div>
</div>
</div>
<input id="7173de83-bb91-4d9d-b3d8-5f33ae9953cf" name="c97cce4f-df89-4357-85c9-44c4dd165013" type="radio">
</input><label class="sd-tab-label" for="7173de83-bb91-4d9d-b3d8-5f33ae9953cf">
prod.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>A NPT simulation <span class="k">for</span> common production-level simulations
 <span class="p">&amp;</span>cntrl
  <span class="nv">imin</span><span class="o">=</span><span class="m">0</span>,        ! Turn off minimization
  <span class="nv">irest</span><span class="o">=</span><span class="m">1</span>,       ! This is a restart of an old MD simulation
  <span class="nv">ntx</span><span class="o">=</span><span class="m">5</span>,         ! So our inpcrd file has velocities
  
  ! Temperature control
  <span class="nv">ntt</span><span class="o">=</span><span class="m">3</span>,         ! Langevin dynamics
  <span class="nv">gamma_ln</span><span class="o">=</span><span class="m">2</span>.0,  ! Friction coefficient <span class="o">(</span>ps^-1<span class="o">)</span>   
  <span class="nv">temp0</span><span class="o">=</span><span class="m">300</span>,     ! Target temperature
  
  ! Potential energy control
  <span class="nv">cut</span><span class="o">=</span><span class="m">8</span>.0,       ! nonbonded cutoff, <span class="k">in</span> angstroms

  ! MD settings
  <span class="nv">nstlim</span><span class="o">=</span><span class="m">50000</span>,  ! MD steps
  <span class="nv">dt</span><span class="o">=</span><span class="m">0</span>.002,      ! Time step <span class="o">(</span>ps<span class="o">)</span>

  ! SHAKE
  <span class="nv">ntc</span><span class="o">=</span><span class="m">2</span>,         ! Constrain bonds containing hydrogen
  <span class="nv">ntf</span><span class="o">=</span><span class="m">2</span>,         ! Do not calculate forces of bonds containing hydrogen
  
  ! Control how often information is printed
  <span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,      ! Print coordinates every ntwx steps to the trajectory  
  <span class="nv">ntpr</span><span class="o">=</span><span class="m">100</span>,
  <span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,

  ! Constant pressure control.
  <span class="nv">barostat</span><span class="o">=</span><span class="m">1</span>,    ! Berendsen barostat... change to <span class="m">2</span> <span class="k">for</span> MC
  <span class="nv">ntp</span><span class="o">=</span><span class="m">1</span>,         ! <span class="nv">1</span><span class="o">=</span>isotropic, <span class="nv">2</span><span class="o">=</span>anisotropic, <span class="nv">3</span><span class="o">=</span>semi-isotropic w/ surften
  <span class="nv">pres0</span><span class="o">=</span><span class="m">1</span>.0,     ! Target external pressure, <span class="k">in</span> bar
  <span class="nv">taup</span><span class="o">=</span><span class="m">1</span>.0,      ! Pressure relaxation <span class="nb">time</span> <span class="o">(</span><span class="k">in</span> ps<span class="o">)</span>
 /
 
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-the-simulation">
<h2>Running the Simulation<a class="headerlink" href="#running-the-simulation" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Amber has 2 MD engines called, <code class="docutils literal notranslate"><span class="pre">sander</span></code> and <code class="docutils literal notranslate"><span class="pre">pmemd</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sander</span></code> is free and shipped with Ambertools</p></li>
</ul>
<p>Using <code class="docutils literal notranslate"><span class="pre">sander</span></code>, run the following commands in sequential order:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="9e5a1421-3fb6-4d2c-a315-fe72c686cae8" name="b65bb841-dc78-4525-b5c8-93afd5402c99" type="radio">
</input><label class="sd-tab-label" for="9e5a1421-3fb6-4d2c-a315-fe72c686cae8">
Step 1 - Minimization</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander -O -i min.mdin -p step3_pbcsetup.parm7 -c step3_pbcsetup.rst7 -o min.mdout -r min.ncrst -inf min.mdinfo
</pre></div>
</div>
</div>
<input id="4a7ca5e9-e421-4ba2-ab7c-7b16dd28339f" name="b65bb841-dc78-4525-b5c8-93afd5402c99" type="radio">
</input><label class="sd-tab-label" for="4a7ca5e9-e421-4ba2-ab7c-7b16dd28339f">
Step 2 - Heating</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander -O -i heat.mdin -p step3_pbcsetup.parm7 -c min.ncrst -o heat.mdout -r heat.ncrst -inf heat.mdinfo -x heat.nc
</pre></div>
</div>
</div>
<input id="5c37c980-80f0-4335-9af6-f5a085cbcbe5" name="b65bb841-dc78-4525-b5c8-93afd5402c99" type="radio">
</input><label class="sd-tab-label" for="5c37c980-80f0-4335-9af6-f5a085cbcbe5">
Step 3 - Production MD</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander -O -i prod.mdin -p step3_pbcsetup.parm7 -c heat.ncrst -o prod.mdout -r prod.ncrst -inf prod.mdinfo -x prod.nc
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-trajectory">
<h2>Visualize Trajectory<a class="headerlink" href="#visualize-trajectory" title="Permalink to this headline">#</a></h2>
<p>Now you can visual the results with VMD or Chimera, and perform some analysis.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/02-simulation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="md.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Classical MD</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="distance.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Applying Distance Restraints in Classical MD SImulations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Richard Van<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>