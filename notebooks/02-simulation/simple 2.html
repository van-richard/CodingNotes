
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.3.1. Simple MD Tutorial of Alanine Dipeptide &#8212; CodingNotes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/02-simulation/simple';</script>
    <link rel="canonical" href="https://van-richard.github.io/CodingNotes/notebooks/02-simulation/simple.html" />
    <link rel="icon" href="../../_static/van-codingnotes.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.3.2. Applying Distance Restraints in Classical MD Simulations" href="distance.html" />
    <link rel="prev" title="3.3. Tutorial" href="tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search mee!!"
         aria-label="Search mee!!"
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/van-abstract-y-light.svg" class="logo__image only-light" alt=""/>
    <img src="../../_static/van-abstract-y-dark.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">CodingNotes</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../00-quickstart/00_overview.html">
    quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../01-scripting/00_overview.html">
    scripting
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="00_overview.html">
    simulations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../morenotes.html">
    More Notes !!
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>
        </div>
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://scholar.google.com/citations?user=YQmlIIwAAAAJ&hl=en" title="Google Scholar" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-google fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Google Scholar</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/van-richard" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/OMGITSvanADIUM" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://linkedin.com/van-richard" title="Linkedin" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Linkedin</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>
    </div>
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../00-quickstart/00_overview.html">
    quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../01-scripting/00_overview.html">
    scripting
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="00_overview.html">
    simulations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../morenotes.html">
    More Notes !!
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://scholar.google.com/citations?user=YQmlIIwAAAAJ&hl=en" title="Google Scholar" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-google fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Google Scholar</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/van-richard" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/OMGITSvanADIUM" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://linkedin.com/van-richard" title="Linkedin" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Linkedin</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="theory.html">3.1. Theory / Methods Overview</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="theory-binding.html">3.1.4.1. Binding Affinity</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory-classical.html">3.1.4.2. Classical Molecular Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory-fe-alchemical.html">3.1.4.3. FE Alchem</a></li>

<li class="toctree-l2"><a class="reference internal" href="theory-fe-estimators.html">3.1.4.5. Free Energy Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory-qmmm.html">3.1.4.6. QM/MM Simulations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="amber.html">3.2. Compile Notes</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="amber-install-helpmelib.html">3.2.1. Compile <code class="docutils literal notranslate"><span class="pre">helpmelib</span></code> executable</a></li>
<li class="toctree-l2"><a class="reference internal" href="amber-install-patch.html">3.2.2. Patch / Compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="amber-install-qmhub.html">3.2.3. Install QMHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="amber-install-torchmdnet.html">3.2.4. TorchMDnet-ext Environment (CPU)</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tutorial.html">3.3. Tutorial</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.3.1. Simple MD Tutorial of Alanine Dipeptide</a></li>
<li class="toctree-l2"><a class="reference internal" href="distance.html">3.3.2. Applying Distance Restraints in Classical MD Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="claisen.html">3.3.3. QM/MM Simulation of the Claisen Rearrangment Reaction</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="analysis.html">3.4. Analysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="analysis-cpptraj-dry.html">3.4.1. Export Dry Trajectory (no water)</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-pymbar.html">3.4.2. Plot PMF with PyMBAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-pytraj-2drmsd.html">3.4.3. Pairwise Distance Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-pytraj-pca.html">3.4.4. Principal Component Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-pytraj-rdf.html">3.4.5. RDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-pytraj-rmsd.html">3.4.6. Root Mean Square Deviation (RMSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-pytraj-rmsf.html">3.4.7. Root Mean Square Fluctuation (RMSF)</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="00_overview.html" class="nav-link"><span class="section-number">3. </span>simulations</a></li>
    
    
    <li class="breadcrumb-item"><a href="tutorial.html" class="nav-link"><span class="section-number">3.3. </span>Tutorial</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis"><span class="section-number">3.3.1. </span>Simple MD Tutorial of Alanine Dipeptide</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simple-md-tutorial-of-alanine-dipeptide">
<h1><span class="section-number">3.3.1. </span>Simple MD Tutorial of Alanine Dipeptide<a class="headerlink" href="#simple-md-tutorial-of-alanine-dipeptide" title="Link to this heading">#</a></h1>
<p>A simple example of how to run MD simulations is with the molecule, Alanine Dipeptide. We will model the residue, solvate it in a water box, equilibrate the system, and run MD production simulations with AmberTools. This should take roughly an hour.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/simple.mov"><img alt="../../_images/simple.mov" src="../../_images/simple.mov" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">MD trajectory of Alanine Dipeptide (<em>shown as ball-and-stick</em>) solvated in water (<em>shown as line</em>) viewed on VMD.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The system, Alanine Dipeptide, is the amino acid, Alanine, with the charged ends neutralized. This is done by “capping” the N-terminal with an acetyl group, and C-terminal with N-methylamide.</p>
<p>In this tutorial, we will:</p>
<ul class="simple">
<li><p>Make a <code class="docutils literal notranslate"><span class="pre">~/Tutorials/</span></code> folder all of our projects</p></li>
<li><p>Add a new project folder called <code class="docutils literal notranslate"><span class="pre">simple</span></code></p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">tleap</span></code> to make the molecule (in Amber format)</p></li>
<li><p>Prepare inputs for MD simulations</p></li>
<li><p>Run MD simulations with <code class="docutils literal notranslate"><span class="pre">sander</span></code></p></li>
<li><p>Analyze the trajectory</p></li>
</ul>
<p><strong>This assumes you have already installed some form of conda, and made the conda environment “ambertools”.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This tutorial can be perform on your local computer</p></li>
<li><p>Download my files for reference: <a class="reference external" href="https://github.com/van-richard/CodingNotes/blob/79059b233ce24e12ba779f981d50726ea5ec528c/assets/tar/simple.tar.xz" title="download">simple.tar.bz2</a></p></li>
</ul>
</div>
<section id="prepare-files-folders">
<h2><span class="section-number">3.3.1.1. </span>Prepare Files &amp; Folders<a class="headerlink" href="#prepare-files-folders" title="Link to this heading">#</a></h2>
<p>First, set up the directories by creating a folder for “Tutorials”, then make a project folder for the “simple” simulation project. <em>Optionally, if you downloaded the reference file, we will move <code class="docutils literal notranslate"><span class="pre">simple.tar.bz2</span></code> into a reference folder.</em></p>
<p>Create:</p>
<ol class="arabic simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code> folder in our home</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">simple</span></code> folder inside <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code></p>
<ul class="simple">
<li><p>i.e. ~/Tutorials/simple</p></li>
</ul>
</li>
<li><p>(Optional) The downloaded reference folder <code class="docutils literal notranslate"><span class="pre">simple</span></code> in <code class="docutils literal notranslate"><span class="pre">~/Tutorials/references/</span></code></p>
<ul class="simple">
<li><p>i.e. ~/Tutorials/references/simple</p></li>
</ul>
</li>
</ol>
<p>Open terminal and check where you are:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">pwd</span>
</pre></div>
</div>
<p>Make a new directory for projects called, “Tutorials”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>~/Tutorials
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">~/</span></code> before Tutorials is the home path, i.e. <code class="docutils literal notranslate"><span class="pre">$HOME/Tutorials</span></code>.</p>
<p>Go inside <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code> and  make the first project folder called, “simple”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>simple
</pre></div>
</div>
<p>If you downloaded my reference files, then make another folder called “references”, with <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">references</span></code>, then unzip and move the folder into references,</p>
<div class="dropdown admonition">
<p class="admonition-title">Try me!!</p>
<p>Assuming you saved my reference file by using your mouse, moved the file to <code class="docutils literal notranslate"><span class="pre">~/Tutorials</span></code>, and extracted the files by clicking…</p>
<p>I want to share the command line approach! Downloading and extracting compressed files via command line is helpful because it can be automated! Plus, in the future, we don’t want to download files locally, then upload to the supercomputer… It becomes tedious…</p>
<p>In the terminal, go to where you want the file to be saved (<code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~/Tutorials/</span></code>):</p>
<ul class="simple">
<li><p>Download the <code class="docutils literal notranslate"><span class="pre">.tar.bz2</span></code> file with either <code class="docutils literal notranslate"><span class="pre">curl</span></code> or <code class="docutils literal notranslate"><span class="pre">wget</span></code> <em>depending on your OS</em>.</p></li>
<li><p>Extract the files with <code class="docutils literal notranslate"><span class="pre">tar</span></code></p></li>
</ul>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
MacOS</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-<span class="w"> </span>O<span class="w"> </span>https://van-richard.github.io/CodingNotes/_downloads/053d20a2b9fe9f09025552a74192e439/simple.tar.bz2
tar<span class="w"> </span>xvfj<span class="w"> </span>simple.tar.bz2<span class="w"> </span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
Linux</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://van-richard.github.io/CodingNotes/_downloads/053d20a2b9fe9f09025552a74192e439/simple.tar.bz2
tar<span class="w"> </span>xvfj<span class="w"> </span>simple.tar.bz2<span class="w"> </span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p>In terms of the terminal, do you know where you are or what is in this directory? If you forgot the path, then run <code class="docutils literal notranslate"><span class="pre">pwd</span></code>. This will tell you where you are with respect to your home directory. To see files/folders, run <code class="docutils literal notranslate"><span class="pre">ls</span></code>.</p>
</div>
</section>
<section id="prepare-topology-and-coordinate-files-inputs">
<h2><span class="section-number">3.3.1.2. </span>Prepare Topology and Coordinate Files Inputs<a class="headerlink" href="#prepare-topology-and-coordinate-files-inputs" title="Link to this heading">#</a></h2>
<p>Since Alanine dipeptide is still an amino acid, we can use <code class="docutils literal notranslate"><span class="pre">tleap</span></code> to generate the topology (<code class="docutils literal notranslate"><span class="pre">.parm7</span></code>) and coordinate files(<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>). The <code class="docutils literal notranslate"><span class="pre">tleap</span></code> program contains reference coordinates for standard residues to generate  missing atoms, this function is base on the residue name.</p>
<p>To give <code class="docutils literal notranslate"><span class="pre">tleap</span></code> instructions, make a file called, “<a class="reference external" href="http://tleap.in">tleap.in</a>” using <code class="docutils literal notranslate"><span class="pre">vi</span></code>, and copy the following lines:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nb">source</span><span class="w"> </span>leaprc.protein.ff19SB
<span class="linenos"> 2</span><span class="nb">source</span><span class="w"> </span>leaprc.water.TIP3P
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="nv">system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>sequence<span class="w"> </span><span class="o">{</span><span class="w"> </span>ACE<span class="w"> </span>ALA<span class="w"> </span>NME<span class="w"> </span><span class="o">}</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>solvatebox<span class="w"> </span>system<span class="w"> </span>TIP3PBOX<span class="w"> </span><span class="m">12</span>.0<span class="w"> </span>iso<span class="w"> </span><span class="m">0</span>.8
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>saveamberparm<span class="w"> </span>system<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>step3_pbcsetup.rst7
<span class="linenos"> 9</span>
<span class="linenos">10</span>quit
</pre></div>
</div>
<p>Briefly, the:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code> line tell Amber which force field parameters we want for our molecules, this is always at the top of the file</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">leaprc.protein.ff19SB</span></code> contains protein parameters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">leaprc.water.TIP3P</span></code> has the water parameters</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">system</span> <span class="pre">=</span> <span class="pre">sequence</span> <span class="pre">{</span> <span class="pre">ACE</span> <span class="pre">ALA</span> <span class="pre">NME</span> <span class="pre">}</span></code> line makes use of the <code class="docutils literal notranslate"><span class="pre">sequence</span></code> command which combines amino acid residues together to build a molecule, and this is stored as “system” variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solvatebox</span> <span class="pre">system</span> <span class="pre">TIP3PBOX</span> <span class="pre">12.0</span> <span class="pre">iso</span> <span class="pre">0.8</span></code> line create a a water box around the <code class="docutils literal notranslate"><span class="pre">system</span></code>, such that the minimum distance between any atom in <code class="docutils literal notranslate"><span class="pre">system</span></code> and the edge of the periodic box <code class="docutils literal notranslate"><span class="pre">12.0</span></code> Å.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">iso</span></code> rotates the <code class="docutils literal notranslate"><span class="pre">system</span></code> to orient the principal axes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code> is how close a solvent atom can be to the system atoms</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveamberparm</span> <span class="pre">system</span> <span class="pre">step3_pbcsetup.parm7</span> <span class="pre">step3_pbcsetup.rst7</span></code> line saves <code class="docutils literal notranslate"><span class="pre">system</span></code> as Amber topology (<code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.parm7</span></code>) and coordinate (<code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.rst7</span></code>) files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quit</span></code> line exits the tleap program.</p></li>
</ul>
<p>Now we can run <code class="docutils literal notranslate"><span class="pre">tleap</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap<span class="w"> </span>-sf<span class="w"> </span>tleap.in
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-sf</span></code> for <code class="docutils literal notranslate"><span class="pre">tleap</span></code> lets us run the script <code class="docutils literal notranslate"><span class="pre">tleap.in</span></code>, otherwise it will run interactively in the command line</p>
<p>If you list the files in this directory, you should see <code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.parm7</span></code> and <code class="docutils literal notranslate"><span class="pre">step3_pbcsetup.rst7</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Visualize these two files with VMD. Always do this before moving on!</p>
</div>
</section>
<section id="prepare-md-inputs-simulation-settings">
<h2><span class="section-number">3.3.1.3. </span>Prepare MD Inputs - Simulation Settings<a class="headerlink" href="#prepare-md-inputs-simulation-settings" title="Link to this heading">#</a></h2>
<p>Now, we will make 3 MD input files for running Amber simulations. These files contain the settings for each part of the simulations. The 3 parts involve:</p>
<ol class="arabic simple">
<li><p>Minimization</p></li>
<li><p>Heating (for 20 ps from 0 K to 300 K)</p></li>
<li><p>Production MD (100 ps at 300 K and 1 atm)</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
min.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Minimization<span class="w"> </span>input<span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>explicit<span class="w"> </span>solvent
<span class="w"> </span><span class="p">&amp;</span>cntrl
<span class="w">  </span>!<span class="w"> </span>Minimization<span class="w"> </span>options
<span class="w">  </span><span class="nv">imin</span><span class="o">=</span><span class="m">1</span><span class="w">         </span>!<span class="w"> </span>Turn<span class="w"> </span>on<span class="w"> </span>minimization
<span class="w">  </span><span class="nv">maxcyc</span><span class="o">=</span><span class="m">2000</span>,<span class="w">   </span>!<span class="w">  </span>Maximum<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>minimization<span class="w"> </span>cycles
<span class="w">  </span><span class="nv">ncyc</span><span class="o">=</span><span class="m">1000</span>,<span class="w">     </span>!<span class="w"> </span>Steepest-descent<span class="w"> </span>steps,<span class="w"> </span>better<span class="w"> </span><span class="k">for</span><span class="w"> </span>strained<span class="w"> </span>systems<span class="w">       </span>

<span class="w">  </span>!<span class="w"> </span>Potential<span class="w"> </span>energy<span class="w"> </span><span class="k">function</span><span class="w"> </span>options
<span class="w">  </span><span class="nv">cut</span><span class="o">=</span><span class="m">8</span>.0,<span class="w">       </span>!<span class="w"> </span>nonbonded<span class="w"> </span>cutoff,<span class="w"> </span><span class="k">in</span><span class="w"> </span>angstroms
<span class="w"> </span>
<span class="w">  </span>!<span class="w"> </span>Control<span class="w"> </span>how<span class="w"> </span>often<span class="w"> </span>information<span class="w"> </span>is<span class="w"> </span>printed<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>file
<span class="w">  </span><span class="nv">ntpr</span><span class="o">=</span><span class="m">100</span>,<span class="w">      </span>!<span class="w"> </span>Print<span class="w"> </span>energies<span class="w"> </span>every<span class="w"> </span><span class="m">100</span><span class="w"> </span>steps
<span class="w"> </span>/
<span class="w"> </span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-3">
heat.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>A<span class="w"> </span>NVT<span class="w"> </span>simulation<span class="w"> </span><span class="k">for</span><span class="w"> </span>common<span class="w"> </span>production-level<span class="w"> </span>simulations
<span class="w"> </span><span class="p">&amp;</span>cntrl
<span class="w">  </span><span class="nv">imin</span><span class="o">=</span><span class="m">0</span>,<span class="w">        </span>!<span class="w"> </span>Turn<span class="w"> </span>off<span class="w"> </span>minimization
<span class="w">  </span><span class="nv">irest</span><span class="o">=</span><span class="m">0</span>,<span class="w">       </span>!<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>NOT<span class="w"> </span>a<span class="w"> </span>restart<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>old<span class="w"> </span>MD<span class="w"> </span>simulation
<span class="w">  </span><span class="nv">ntx</span><span class="o">=</span><span class="m">1</span>,<span class="w">         </span>!<span class="w"> </span>So<span class="w"> </span>our<span class="w"> </span>inpcrd<span class="w"> </span>file<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>velocities
<span class="w">   </span>
<span class="w">  </span>!<span class="w"> </span>Temperature<span class="w"> </span>control
<span class="w">  </span><span class="nv">ntt</span><span class="o">=</span><span class="m">3</span>,<span class="w">         </span>!<span class="w"> </span>Langevin<span class="w"> </span>dynamics
<span class="w">  </span><span class="nv">gamma_ln</span><span class="o">=</span><span class="m">1</span>.0,<span class="w">  </span>!<span class="w"> </span>Friction<span class="w"> </span>coefficient<span class="w"> </span><span class="o">(</span>ps^-1<span class="o">)</span>
<span class="w">  </span><span class="nv">tempi</span><span class="o">=</span><span class="m">0</span>.0,<span class="w">     </span>!<span class="w"> </span>Initial<span class="w"> </span>temp<span class="w"> </span>--<span class="w"> </span>give<span class="w"> </span>it<span class="w"> </span>some<span class="w"> </span>small<span class="w"> </span>random<span class="w"> </span>velocities<span class="w">   </span>
<span class="w">  </span><span class="nv">temp0</span><span class="o">=</span><span class="m">300</span>,<span class="w">     </span>!<span class="w"> </span>Target<span class="w"> </span>temperature

<span class="w">  </span>!<span class="w"> </span>Potential<span class="w"> </span>energy<span class="w"> </span>control
<span class="w">  </span><span class="nv">cut</span><span class="o">=</span><span class="m">0</span>,<span class="w">       </span>!<span class="w"> </span>nonbonded<span class="w"> </span>cutoff,<span class="w"> </span><span class="k">in</span><span class="w"> </span>angstroms
<span class="w"> </span>
<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>settings
<span class="w">  </span><span class="nv">nstlim</span><span class="o">=</span><span class="m">10000</span>,<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>steps
<span class="w">  </span><span class="nv">dt</span><span class="o">=</span><span class="m">0</span>.002,<span class="w">      </span>!<span class="w"> </span>Time<span class="w"> </span>step<span class="w"> </span><span class="o">(</span>ps<span class="o">)</span>

<span class="w">  </span>!<span class="w"> </span>SHAKE
<span class="w">  </span><span class="nv">ntc</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Constrain<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span><span class="nv">ntf</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Do<span class="w"> </span>not<span class="w"> </span>calculate<span class="w"> </span>forces<span class="w"> </span>of<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Control<span class="w"> </span>how<span class="w"> </span>often<span class="w"> </span>information<span class="w"> </span>is<span class="w"> </span>printed
<span class="w">  </span><span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,<span class="w">      </span>!<span class="w"> </span>Print<span class="w"> </span>coordinates<span class="w"> </span>every<span class="w"> </span>ntwx<span class="w"> </span>steps<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>trajectory
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Restraints
<span class="w">  </span><span class="nv">nmropt</span><span class="o">=</span><span class="m">1</span>,<span class="w">      </span>!<span class="w"> </span>Turn<span class="w"> </span>on<span class="w"> </span>Restraints
<span class="w"> </span>/
!<span class="w"> </span>This<span class="w"> </span>section<span class="w"> </span>will<span class="w"> </span>vary<span class="w"> </span>the<span class="w"> </span>temperature<span class="w"> </span>
!<span class="w"> </span>For<span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span><span class="m">9000</span><span class="w"> </span>steps,<span class="w"> </span>temp<span class="w"> </span>increases<span class="w"> </span>from<span class="w"> </span><span class="m">0</span><span class="w"> </span>to<span class="w"> </span><span class="m">300</span><span class="w"> </span>K.
!<span class="w"> </span>For<span class="w"> </span>steps<span class="w"> </span><span class="m">9001</span><span class="w"> </span>to<span class="w"> </span><span class="m">10000</span>,<span class="w"> </span>temp<span class="w"> </span>will<span class="w"> </span>remain<span class="w"> </span>at<span class="w"> </span><span class="m">300</span><span class="w"> </span>K
<span class="p">&amp;</span>wt<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s1">&#39;TEMP0&#39;</span>,<span class="w"> </span><span class="nv">istep1</span><span class="o">=</span><span class="m">0</span>,<span class="w"> </span><span class="nv">istep2</span><span class="o">=</span><span class="m">9000</span>,<span class="w"> </span><span class="nv">value1</span><span class="o">=</span><span class="m">0</span>.0,<span class="w"> </span><span class="nv">value2</span><span class="o">=</span><span class="m">300</span>.0<span class="w"> </span>/
<span class="p">&amp;</span>wt<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s1">&#39;TEMP0&#39;</span>,<span class="w"> </span><span class="nv">istep1</span><span class="o">=</span><span class="m">9001</span>,<span class="w"> </span><span class="nv">istep2</span><span class="o">=</span><span class="m">10000</span>,<span class="w"> </span><span class="nv">value1</span><span class="o">=</span><span class="m">300</span>.0,<span class="w"> </span><span class="nv">value2</span><span class="o">=</span><span class="m">300</span>.0<span class="w"> </span>/
<span class="p">&amp;</span>wt<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s1">&#39;END&#39;</span><span class="w"> </span>/
</pre></div>
</div>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-4">
prod.mdin</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>A<span class="w"> </span>NPT<span class="w"> </span>simulation<span class="w"> </span><span class="k">for</span><span class="w"> </span>common<span class="w"> </span>production-level<span class="w"> </span>simulations
<span class="w"> </span><span class="p">&amp;</span>cntrl
<span class="w">  </span><span class="nv">imin</span><span class="o">=</span><span class="m">0</span>,<span class="w">        </span>!<span class="w"> </span>Turn<span class="w"> </span>off<span class="w"> </span>minimization
<span class="w">  </span><span class="nv">irest</span><span class="o">=</span><span class="m">1</span>,<span class="w">       </span>!<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>restart<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>old<span class="w"> </span>MD<span class="w"> </span>simulation
<span class="w">  </span><span class="nv">ntx</span><span class="o">=</span><span class="m">5</span>,<span class="w">         </span>!<span class="w"> </span>So<span class="w"> </span>our<span class="w"> </span>inpcrd<span class="w"> </span>file<span class="w"> </span>has<span class="w"> </span>velocities
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Temperature<span class="w"> </span>control
<span class="w">  </span><span class="nv">ntt</span><span class="o">=</span><span class="m">3</span>,<span class="w">         </span>!<span class="w"> </span>Langevin<span class="w"> </span>dynamics
<span class="w">  </span><span class="nv">gamma_ln</span><span class="o">=</span><span class="m">2</span>.0,<span class="w">  </span>!<span class="w"> </span>Friction<span class="w"> </span>coefficient<span class="w"> </span><span class="o">(</span>ps^-1<span class="o">)</span><span class="w">   </span>
<span class="w">  </span><span class="nv">temp0</span><span class="o">=</span><span class="m">300</span>,<span class="w">     </span>!<span class="w"> </span>Target<span class="w"> </span>temperature
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Potential<span class="w"> </span>energy<span class="w"> </span>control
<span class="w">  </span><span class="nv">cut</span><span class="o">=</span><span class="m">8</span>.0,<span class="w">       </span>!<span class="w"> </span>nonbonded<span class="w"> </span>cutoff,<span class="w"> </span><span class="k">in</span><span class="w"> </span>angstroms

<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>settings
<span class="w">  </span><span class="nv">nstlim</span><span class="o">=</span><span class="m">50000</span>,<span class="w">  </span>!<span class="w"> </span>MD<span class="w"> </span>steps
<span class="w">  </span><span class="nv">dt</span><span class="o">=</span><span class="m">0</span>.002,<span class="w">      </span>!<span class="w"> </span>Time<span class="w"> </span>step<span class="w"> </span><span class="o">(</span>ps<span class="o">)</span>

<span class="w">  </span>!<span class="w"> </span>SHAKE
<span class="w">  </span><span class="nv">ntc</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Constrain<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span><span class="nv">ntf</span><span class="o">=</span><span class="m">2</span>,<span class="w">         </span>!<span class="w"> </span>Do<span class="w"> </span>not<span class="w"> </span>calculate<span class="w"> </span>forces<span class="w"> </span>of<span class="w"> </span>bonds<span class="w"> </span>containing<span class="w"> </span>hydrogen
<span class="w">  </span>
<span class="w">  </span>!<span class="w"> </span>Control<span class="w"> </span>how<span class="w"> </span>often<span class="w"> </span>information<span class="w"> </span>is<span class="w"> </span>printed
<span class="w">  </span><span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,<span class="w">      </span>!<span class="w"> </span>Print<span class="w"> </span>coordinates<span class="w"> </span>every<span class="w"> </span>ntwx<span class="w"> </span>steps<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>trajectory<span class="w">  </span>
<span class="w">  </span><span class="nv">ntpr</span><span class="o">=</span><span class="m">100</span>,
<span class="w">  </span><span class="nv">ntwx</span><span class="o">=</span><span class="m">100</span>,

<span class="w">  </span>!<span class="w"> </span>Constant<span class="w"> </span>pressure<span class="w"> </span>control.
<span class="w">  </span><span class="nv">barostat</span><span class="o">=</span><span class="m">1</span>,<span class="w">    </span>!<span class="w"> </span>Berendsen<span class="w"> </span>barostat...<span class="w"> </span>change<span class="w"> </span>to<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>MC
<span class="w">  </span><span class="nv">ntp</span><span class="o">=</span><span class="m">1</span>,<span class="w">         </span>!<span class="w"> </span><span class="nv">1</span><span class="o">=</span>isotropic,<span class="w"> </span><span class="nv">2</span><span class="o">=</span>anisotropic,<span class="w"> </span><span class="nv">3</span><span class="o">=</span>semi-isotropic<span class="w"> </span>w/<span class="w"> </span>surften
<span class="w">  </span><span class="nv">pres0</span><span class="o">=</span><span class="m">1</span>.0,<span class="w">     </span>!<span class="w"> </span>Target<span class="w"> </span>external<span class="w"> </span>pressure,<span class="w"> </span><span class="k">in</span><span class="w"> </span>bar
<span class="w">  </span><span class="nv">taup</span><span class="o">=</span><span class="m">1</span>.0,<span class="w">      </span>!<span class="w"> </span>Pressure<span class="w"> </span>relaxation<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span>ps<span class="o">)</span>
<span class="w"> </span>/
<span class="w"> </span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-the-simulation">
<h2><span class="section-number">3.3.1.4. </span>Running the Simulation<a class="headerlink" href="#running-the-simulation" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Amber has 2 MD engines called, <code class="docutils literal notranslate"><span class="pre">sander</span></code> and <code class="docutils literal notranslate"><span class="pre">pmemd</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sander</span></code> is free and shipped with Ambertools</p></li>
</ul>
<p>Using <code class="docutils literal notranslate"><span class="pre">sander</span></code>, run the following commands in sequential order:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" for="sd-tab-item-5">
Step 1 - Minimization</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>min.mdin<span class="w"> </span>-p<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>-c<span class="w"> </span>step3_pbcsetup.rst7<span class="w"> </span>-o<span class="w"> </span>min.mdout<span class="w"> </span>-r<span class="w"> </span>min.ncrst<span class="w"> </span>-inf<span class="w"> </span>min.mdinfo
</pre></div>
</div>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" for="sd-tab-item-6">
Step 2 - Heating</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>heat.mdin<span class="w"> </span>-p<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>-c<span class="w"> </span>min.ncrst<span class="w"> </span>-o<span class="w"> </span>heat.mdout<span class="w"> </span>-r<span class="w"> </span>heat.ncrst<span class="w"> </span>-inf<span class="w"> </span>heat.mdinfo<span class="w"> </span>-x<span class="w"> </span>heat.nc
</pre></div>
</div>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" for="sd-tab-item-7">
Step 3 - Production MD</label><div class="sd-tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sander<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>prod.mdin<span class="w"> </span>-p<span class="w"> </span>step3_pbcsetup.parm7<span class="w"> </span>-c<span class="w"> </span>heat.ncrst<span class="w"> </span>-o<span class="w"> </span>prod.mdout<span class="w"> </span>-r<span class="w"> </span>prod.ncrst<span class="w"> </span>-inf<span class="w"> </span>prod.mdinfo<span class="w"> </span>-x<span class="w"> </span>prod.nc
</pre></div>
</div>
<div class="docutils">
</div>
</div>
</div>
</section>
<section id="visualize-trajectory">
<h2><span class="section-number">3.3.1.5. </span>Visualize Trajectory<a class="headerlink" href="#visualize-trajectory" title="Link to this heading">#</a></h2>
<p>Now you can visual the results with VMD or Chimera, and perform some analysis.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/02-simulation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.3. </span>Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="distance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.3.2. </span>Applying Distance Restraints in Classical MD Simulations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-files-folders">3.3.1.1. Prepare Files &amp; Folders</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-topology-and-coordinate-files-inputs">3.3.1.2. Prepare Topology and Coordinate Files Inputs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-md-inputs-simulation-settings">3.3.1.3. Prepare MD Inputs - Simulation Settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-simulation">3.3.1.4. Running the Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-trajectory">3.3.1.5. Visualize Trajectory</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/notebooks/02-simulation/simple.md"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>